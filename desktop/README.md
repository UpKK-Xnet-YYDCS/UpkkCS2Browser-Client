# XProj Desktop

ç°ä»£åŒ–çš„æ¸¸æˆæœåŠ¡å™¨æµè§ˆå™¨æ¡Œé¢å®¢æˆ·ç«¯ï¼ŒåŸºäº Tauri + React + TypeScript æ„å»ºã€‚

## ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½**: åŸºäº Tauri (Rust) æ„å»ºï¼Œå†…å­˜å ç”¨ä½ï¼Œå¯åŠ¨é€Ÿåº¦å¿«
- ğŸ¨ **ç°ä»£åŒ–UI**: ä½¿ç”¨ React 19 + Tailwind CSS 4ï¼Œæ”¯æŒæš—è‰²æ¨¡å¼
- ğŸ”Œ **APIå¯¹æ¥**: ä¸ XProj åç«¯ API å®Œå…¨å¯¹æ¥
- â­ **æ”¶è—åŠŸèƒ½**: æœ¬åœ°æ”¶è—å–œçˆ±çš„æœåŠ¡å™¨
- ğŸ” **æœç´¢åŠŸèƒ½**: æ”¯æŒæœåŠ¡å™¨åç§°ã€åœ°å›¾ã€IPæœç´¢
- ğŸŒ **åŒºåŸŸç­›é€‰**: æŒ‰åœ°åŒºç­›é€‰æœåŠ¡å™¨
- ğŸ“¦ **è½»é‡å®‰è£…åŒ…**: çº¦ 10MB (vs Electron 150MB+)

## æŠ€æœ¯æ ˆ

- **æ¡Œé¢æ¡†æ¶**: [Tauri 2.x](https://tauri.app/) (Rust)
- **å‰ç«¯æ¡†æ¶**: React 19 + TypeScript
- **æ ·å¼**: Tailwind CSS 4
- **æ„å»ºå·¥å…·**: Vite 7
- **çŠ¶æ€ç®¡ç†**: React Context + useReducer (æ— å¤–éƒ¨ä¾èµ–)
- **HTTPè¯·æ±‚**: åŸç”Ÿ Fetch API (æ— å¤–éƒ¨ä¾èµ–)

## å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js 20+
- Rust (é€šè¿‡ [rustup](https://rustup.rs/) å®‰è£…)
- Windows: Microsoft Visual Studio C++ Build Tools
- Linux: `libwebkit2gtk-4.1-dev libappindicator3-dev librsvg2-dev`

### å®‰è£…ä¾èµ–

```bash
cd desktop
npm install
```

### å¼€å‘æ¨¡å¼

```bash
# ä»…å‰ç«¯å¼€å‘ (æµè§ˆå™¨)
npm run dev

# Tauri æ¡Œé¢å¼€å‘ (å¸¦çƒ­é‡è½½)
npm run tauri:dev
```

### æ„å»º

```bash
# æ„å»ºå‰ç«¯
npm run build

# æ„å»ºæ¡Œé¢åº”ç”¨
npm run tauri:build
```

æ„å»ºäº§ç‰©ä½äº `src-tauri/target/release/bundle/`:
- Windows: `.msi` å’Œ `.exe` å®‰è£…åŒ…
- Linux: `.AppImage` å’Œ `.deb` åŒ…

## é…ç½®

### API æœåŠ¡å™¨åœ°å€

åº”ç”¨å¯åŠ¨åï¼Œç‚¹å‡»å³ä¸Šè§’è®¾ç½®æŒ‰é’®ï¼Œè¾“å…¥ XProj åç«¯æœåŠ¡å™¨åœ°å€ã€‚

é»˜è®¤åœ°å€: `http://localhost:8216`

### è‡ªåŠ¨æ›´æ–°

åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹æ›´æ–°ï¼Œä»ä»¥ä¸‹åœ°å€è·å–æ›´æ–°ä¿¡æ¯ï¼š

```
https://update-software.upkk.com/xproj-server-clients/update.json
```

#### update.json æ ¼å¼

```json
{
  "version": "1.0.1",
  "release_date": "2026-02-07",
  "download_url": "https://update-software.upkk.com/xproj-server-clients/releases/1.0.1/upkk-server-browser-1.0.1-setup.exe",
  "changelog": "- æ–°å¢åŠŸèƒ½A\n- ä¿®å¤é—®é¢˜B\n- ä¼˜åŒ–æ€§èƒ½C",
  "mandatory": false,
  "min_version": "0.9.0"
}
```

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `version` | string | âœ… | æœ€æ–°ç‰ˆæœ¬å· (semver æ ¼å¼ï¼Œå¦‚ `1.0.1`) |
| `release_date` | string | âŒ | å‘å¸ƒæ—¥æœŸ (å¦‚ `2026-02-07`) |
| `download_url` | string | âœ… | å®‰è£…ç¨‹åºä¸‹è½½åœ°å€ (å•ä¸ª exe æ–‡ä»¶) |
| `changelog` | string | âŒ | æ›´æ–°æ—¥å¿—ï¼Œæ”¯æŒæ¢è¡Œç¬¦ `\n` |
| `mandatory` | boolean | âŒ | æ˜¯å¦å¼ºåˆ¶æ›´æ–°ï¼Œé»˜è®¤ `false` |
| `min_version` | string | âŒ | æœ€ä½æ”¯æŒç‰ˆæœ¬ï¼Œä½äºæ­¤ç‰ˆæœ¬å°†å¼ºåˆ¶æ›´æ–° |

**æ›´æ–°é€»è¾‘**ï¼š
- å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ä¸€æ¬¡
- å¦‚æœæœ‰æ–°ç‰ˆæœ¬ï¼Œå¼¹å‡ºæ›´æ–°æç¤º
- ç”¨æˆ·å¯é€‰æ‹©"ç¨åæé†’"è·³è¿‡æ­¤ç‰ˆæœ¬
- å¦‚æœ `mandatory` ä¸º `true` æˆ–å½“å‰ç‰ˆæœ¬ä½äº `min_version`ï¼Œåˆ™å¼ºåˆ¶æ›´æ–°

### è‡ªåŠ¨åŒ–æ„å»º

é¡¹ç›®é…ç½®äº† GitHub Actions å·¥ä½œæµï¼Œæ¨é€åˆ° `desktop/` ç›®å½•æ—¶è‡ªåŠ¨è§¦å‘æ„å»ºï¼š

- Windows: ç”Ÿæˆ MSI å’Œ NSIS å®‰è£…åŒ…
- Linux: ç”Ÿæˆ AppImage å’Œ DEB åŒ…

## æ•°æ®å­˜å‚¨

åº”ç”¨ä½¿ç”¨ä»¥ä¸‹ä½ç½®å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼š

### ç™»å½•å‡­æ®å­˜å‚¨

ç™»å½•å‡­æ®ä½¿ç”¨ **AES-256-GCM åŠ å¯†** å­˜å‚¨åœ¨ç³»ç»Ÿåº”ç”¨æ•°æ®ç›®å½•ä¸­ï¼š

| æ“ä½œç³»ç»Ÿ | å­˜å‚¨è·¯å¾„ |
|---------|---------|
| Windows | `%APPDATA%\com.upkk.server-browser\credentials.enc` |
| Linux | `~/.local/share/com.upkk.server-browser/credentials.enc` |
| macOS | `~/Library/Application Support/com.upkk.server-browser/credentials.enc` |

**å®‰å…¨ç‰¹æ€§**ï¼š
- ğŸ” **AES-256-GCM åŠ å¯†**: å‡­æ®ä½¿ç”¨ AES-256-GCM ç®—æ³•åŠ å¯†å­˜å‚¨
- ğŸ–¥ï¸ **è®¾å¤‡ç»‘å®š**: åŠ å¯†å¯†é’¥ä¸è®¾å¤‡å”¯ä¸€æ ‡è¯†ç¬¦ç»‘å®šï¼Œå‡­æ®æ–‡ä»¶å¤åˆ¶åˆ°å…¶ä»–è®¾å¤‡åæ— æ³•è§£å¯†
- ğŸ”„ **è‡ªåŠ¨ç™»å½•**: å¯åŠ¨æ—¶è‡ªåŠ¨ä½¿ç”¨ä¿å­˜çš„å‡­æ®ç™»å½•

### åº”ç”¨è®¾ç½®å­˜å‚¨

åº”ç”¨è®¾ç½®ä½¿ç”¨æµè§ˆå™¨ `localStorage` å­˜å‚¨ï¼Œæ•°æ®ä¿å­˜åœ¨ WebView çš„æœ¬åœ°å­˜å‚¨ä¸­ï¼š

| å­˜å‚¨é”® | è¯´æ˜ |
|-------|------|
| `xproj-desktop-state` | åº”ç”¨çŠ¶æ€ (æ”¶è—æœåŠ¡å™¨ã€APIåœ°å€ã€åŒºåŸŸç­›é€‰ã€æ¸¸æˆç±»å‹ã€è§†å›¾æ¨¡å¼ã€æ¯é¡µæ•°é‡) |
| `upkk-theme-settings` | ä¸»é¢˜è®¾ç½® (æš—è‰²æ¨¡å¼ã€é¢œè‰²é…ç½®ã€èƒŒæ™¯å›¾ç‰‡ã€æ¯›ç»ç’ƒæ•ˆæœ) |
| `xproj-remember-me` | è®°ä½ç™»å½•çŠ¶æ€é€‰é¡¹ |
| `xproj-user-session` | ç”¨æˆ·ä¼šè¯ä¿¡æ¯ |
| `autoRefreshInterval` | è‡ªåŠ¨åˆ·æ–°é—´éš” |

### è®¾å¤‡æ ‡è¯†ç¬¦

å¦‚æœæ— æ³•è·å–ç¡¬ä»¶è®¾å¤‡IDï¼Œåº”ç”¨ä¼šåœ¨ç”¨æˆ·ä¸»ç›®å½•ç”Ÿæˆå¤‡ç”¨è®¾å¤‡æ ‡è¯†ç¬¦ï¼š

| æ“ä½œç³»ç»Ÿ | å­˜å‚¨è·¯å¾„ |
|---------|---------|
| Windows | `%USERPROFILE%\.xproj-device-id` |
| Linux/macOS | `~/.xproj-device-id` |

### æ¸…é™¤æ•°æ®

åœ¨è®¾ç½®é¡µé¢ç‚¹å‡»"æ¸…é™¤æ•°æ®å¹¶é‡å¯"æŒ‰é’®å¯æ¸…é™¤æ‰€æœ‰æœ¬åœ°å­˜å‚¨çš„æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
- localStorage æ•°æ®
- sessionStorage æ•°æ®
- IndexedDB æ•°æ®

> âš ï¸ æ³¨æ„ï¼šæ¸…é™¤æ•°æ®åéœ€è¦é‡æ–°ç™»å½•ã€‚

## ç›®å½•ç»“æ„

```
desktop/
â”œâ”€â”€ src/                  # React æºä»£ç 
â”‚   â”œâ”€â”€ api/              # API è°ƒç”¨å±‚
â”‚   â”œâ”€â”€ components/       # UI ç»„ä»¶
â”‚   â”œâ”€â”€ pages/            # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ services/         # æœåŠ¡æ¨¡å— (æ›´æ–°æ£€æµ‹ç­‰)
â”‚   â”œâ”€â”€ store/            # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ types/            # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ src-tauri/            # Tauri/Rust ä»£ç 
â”‚   â”œâ”€â”€ src/              # Rust æºä»£ç 
â”‚   â”œâ”€â”€ icons/            # åº”ç”¨å›¾æ ‡
â”‚   â””â”€â”€ tauri.conf.json   # Tauri é…ç½®
â”œâ”€â”€ package.json          # NPM é…ç½®
â””â”€â”€ vite.config.ts        # Vite é…ç½®
```

## è®¸å¯è¯

MIT License
